# Default values for mongodb-community-database.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# -- Override the name of the chart
nameOverride: ""

# -- Override the full name of the chart
fullnameOverride: ""

mongodb:
  # -- Annotations to add to the MongoDB deployment
  annotations: {}

  # -- Number of MongoDB replica set members
  members: 3

  # -- MongoDB deployment type
  type: ReplicaSet

  # -- MongoDB version (defaults to .Chart.AppVersion)
  # version: ""

  # -- Feature compatibility version
  featureCompatibilityVersion: ""

  # -- Number of arbiters in the replica set
  arbiters: 0

  # -- Additional mongod configuration
  additionalMongodConfig: {}

  # -- Additional connection string configuration
  additionalConnectionStringConfig: {}

  agent:
    # -- Log level for automation agent
    logLevel: INFO
    # -- Log file path for automation agent
    logFile: ""
    # -- Maximum log file duration in hours
    maxLogFileDurationHours: 24
    systemLog:
      # -- System log destination
      destination: file
      # -- System log file path
      path: /var/log/mongodb-mms-automation/automation-agent.log
      # -- Append to log file
      logAppend: true
    logRotate:
      # -- Log rotation size threshold (MB)
      sizeThresholdMB: "1000"
      # -- Log rotation time threshold (hours)
      timeThresholdHrs: 24
      # -- Total number of log files to keep
      numTotal: 10
      # -- Number of uncompressed log files to keep
      numUncompressed: 5
      # -- Percent of disk space for logs
      percentOfDiskspace: "2.0"
      # -- Include audit logs with MongoDB logs
      includeAuditLogsWithMongoDBLogs: false
    auditLogRotate:
      # -- Audit log rotation size threshold (MB)
      sizeThresholdMB: "1000"
      # -- Audit log rotation time threshold (hours)
      timeThresholdHrs: 24
      # -- Total number of audit log files to keep
      numTotal: 10
      # -- Number of uncompressed audit log files to keep
      numUncompressed: 5
      # -- Percent of disk space for audit logs
      percentOfDiskspace: "2.0"
      # -- Include audit logs with MongoDB logs
      includeAuditLogsWithMongoDBLogs: false

  prometheus:
    # -- Enable Prometheus metrics
    enabled: false
    # -- Prometheus metrics username
    username: "metrics-user"
    # -- Prometheus metrics password
    password: "metrics-password"
    # -- Prometheus exporter port
    port: 9216
    # -- Prometheus metrics path
    metricsPath: "/metrics"
    # -- TLS secret key reference for Prometheus
    tlsSecretKeyRef: {}

  # -- Replica set member configuration
  memberConfig: []

  # -- Replica set horizons for external access
  replicaSetHorizons: []

  security:
    authentication:
      # -- Authentication modes (e.g., SCRAM, X509)
      modes:
        - SCRAM
      # -- Authentication mode for automation agent
      agentMode: ""
      # -- Ignore unknown users
      ignoreUnknownUsers: true
      # -- Agent certificate secret reference for X509
      agentCertificateSecretRef: {}
    tls:
      # -- Enable TLS for MongoDB
      enabled: false
      # -- Make TLS optional
      optional: false
      # -- Certificate and key secret reference
      certificateKeySecretRef: {}
      # -- CA certificate secret reference
      caCertificateSecretRef: {}
      # -- CA certificate config map reference
      caConfigMapRef: {}
    # -- Custom MongoDB roles
    roles: []

  # -- MongoDB users configuration
  users:
    - name: "admin"
      db: "admin"
      password: "admin-password"
      roles:
        - name: "root"
          db: "admin"
      scramCredentialsSecretName: "admin-scram-credentials"
      connectionStringSecretName: ""
      connectionStringSecretNamespace: ""
      additionalConnectionStringConfig: {}
    - name: "fintrade-rw"
      db: "admin"
      password: "fintrade-rw-password"
      roles:
        - name: "readWrite"
          db: "fintrade"
        - name: "dbAdmin"
          db: "fintrade"
      scramCredentialsSecretName: "fintrade-rw-scram-credentials"

  automationConfig:
    # -- Process overrides for automation config
    processes: []
    # -- Replica set configuration overrides
    replicaSet: {}

  statefulSet:
    metadata:
      # -- Additional labels for StatefulSet
      labels: {}
    spec:
      template:
        metadata:
          # -- Additional labels for pod template
          labels: {}
        spec:
          # -- Image pull secrets
          imagePullSecrets: []
          # -- Node selector for pod scheduling
          nodeSelector: {}
          # -- Tolerations for pod scheduling
          tolerations: []
          # -- Affinity rules for pod scheduling
          affinity: {}
          # -- Additional containers
          containers: []
          # -- Additional volumes
          volumes: []
      volumeClaimTemplates:
        - metadata:
            name: "data-volume"
            labels: {}
            annotations: {}
          spec:
            accessModes:
              - "ReadWriteOnce"
            resources:
              requests:
                storage: "10Gi"
            storageClassName: ""
            selector: {}
        - metadata:
            name: "logs-volume"
            labels: {}
            annotations: {}
          spec:
            accessModes:
              - "ReadWriteOnce"
            resources:
              requests:
                storage: "5Gi"
            storageClassName: ""

# -- Service account configuration
serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Automatically mount a ServiceAccount's API credentials
  automount: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use
  name: ""

# -- ServiceMonitor configuration
serviceMonitor:
  # -- Enable or disable the ServiceMonitor
  enabled: false
  # -- Scraping interval for the ServiceMonitor
  interval: "30s"
  # -- Scraping timeout for the ServiceMonitor
  scrapeTimeout: "10s"
  # -- Service labels for selector matching
  serviceLabels:
    app: "mongodb-svc"
  # -- Metric relabeling rules
  metricRelabelings: []
  # -- Relabeling rules
  relabelings: []
